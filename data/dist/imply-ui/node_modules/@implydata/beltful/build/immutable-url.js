"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var immutable_class_1=require("immutable-class");var urlUtil=require("../lib/node-url");var ImmutableURL=function(_super){tslib_1.__extends(ImmutableURL,_super);function ImmutableURL(value){return _super.call(this,value)||this}ImmutableURL.isImmutableURL=function(candidate){return candidate instanceof ImmutableURL};ImmutableURL.fromJS=function(js){var addedProtocol=false;if(js&&!js.includes("://")){js="http://"+js;addedProtocol=true}var value;try{value=urlUtil.parse(js)}catch(e){throw new Error("Could not parse URL: "+e.message)}if(addedProtocol){value.protocol=null}if(value.pathname==="/"&&!js.endsWith("/")){value.pathname=null}return new ImmutableURL(value)};ImmutableURL.fromParts=function(partialURL,defaultProtocol,defaultPort){if(!partialURL)return null;var value=ImmutableURL.fromJS(partialURL).valueOf();if(!value.protocol){value.protocol=defaultProtocol}var retVal=new ImmutableURL(value);if(!retVal.port){retVal=retVal.changePort(defaultPort)}return retVal};ImmutableURL.prototype.changeHostPart=function(key,keyValue){var value=this.valueOf();value[key]=keyValue;return new ImmutableURL(value).changeHost(null)};ImmutableURL.prototype.toString=function(){var value=this.valueOf();var str=urlUtil.format(value);if(value.protocol==null&&str.startsWith("//")){str=str.substring(2)}return str};ImmutableURL.prototype.toJS=function(){return this.toString()};ImmutableURL.prototype.toJSON=function(){return this.toString()};ImmutableURL.prototype.changePort=function(port){return this.changeHostPart("port",port)};ImmutableURL.prototype.changeHostName=function(hostname){return this.changeHostPart("hostname",hostname)};ImmutableURL.PROPERTIES=[{name:"protocol",defaultValue:null},{name:"hostname",defaultValue:null},{name:"host",defaultValue:null},{name:"port",defaultValue:null},{name:"pathname",defaultValue:null},{name:"search",defaultValue:null}];return ImmutableURL}(immutable_class_1.BaseImmutable);exports.ImmutableURL=ImmutableURL;immutable_class_1.BaseImmutable.finalize(ImmutableURL);