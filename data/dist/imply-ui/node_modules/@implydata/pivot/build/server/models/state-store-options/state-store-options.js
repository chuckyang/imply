"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var immutable_class_1=require("immutable-class");var parseConnectionString=require("knex/lib/util/parse-connection");var StateStoreOptions=function(e){tslib_1.__extends(t,e);function t(t){var n=e.call(this,t)||this;if(n.type==="internal"){n.tablePrefix=null;if(!n.readOnly)throw new Error("internal store must be read only")}return n}t.fromJS=function(e){return new t(immutable_class_1.BaseImmutable.jsToValue(t.PROPERTIES,e))};t.prototype.toKnexOptions=function(){var e=this,t=e.type,n=e.connection;if(t==="internal")return null;if(t==="sqlite"){if(typeof n!=="string")throw new Error("connection must be a string");return{client:"sqlite3",connection:{filename:n},useNullAsDefault:true}}if(t==="mysql"){if(typeof n==="string"){n=parseConnectionString(n).connection}if(!n.charset){n.charset="UTF8MB4"}}return{client:t,connection:n}};t.STORE_TYPE_VALUES=["internal","mysql","pg","sqlite"];t.PROPERTIES=[{name:"type",possibleValues:t.STORE_TYPE_VALUES},{name:"connection",equal:immutable_class_1.generalLookupsEqual},{name:"tablePrefix",defaultValue:"pivot-store-"},{name:"readOnly",defaultValue:false}];return t}(immutable_class_1.BaseImmutable);exports.StateStoreOptions=StateStoreOptions;immutable_class_1.BaseImmutable.finalize(StateStoreOptions);