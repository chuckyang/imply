"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");require("./flat-modal.css");var React=require("react");var classNames=require("classnames");var caladan_1=require("@implydata/caladan");var FlatModal=function(_super){tslib_1.__extends(FlatModal,_super);function FlatModal(){var _this=_super.call(this)||this;_this.mounted=false;_this.state={};return _this}FlatModal.prototype.componentDidMount=function(){this.mounted=true;this.updateFromHash();window.addEventListener("hashchange",this.updateFromHash.bind(this))};FlatModal.prototype.componentWillUnmount=function(){this.mounted=false;window.removeEventListener("hashchange",this.updateFromHash.bind(this),false)};FlatModal.prototype.updateFromHash=function(){if(!this.mounted)return;var hash=window.location.hash;if(hash.charAt(0)==="#")hash=hash.substr(1);this.setCrumbs([hash])};FlatModal.prototype.setCrumbs=function(crumbs){if(caladan_1.RouterCore.areSameCrumbs(crumbs,this.state.crumbs))return;this.setState({crumbs:crumbs})};FlatModal.prototype.renderTabs=function(){var tabs=this.props.tabs;var crumbs=this.state.crumbs;var mainColor="hsla(200, 100%, 27%, 1.00)";return tabs.map(function(tab){var active=crumbs&&crumbs[0]===tab.value;return React.createElement(caladan_1.Button,{className:tab.value+"-tab",key:tab.value,title:tab.label,type:"primary",svg:tab.icon,onClick:function(){var hash=window.location.hash.split("/");hash.splice(-1);window.location.hash=hash+tab.value},disabled:tab.disabled,active:active})})};FlatModal.prototype.renderRoutes=function(){var tabs=this.props.tabs;return tabs.map(function(t){return React.createElement(caladan_1.Route,{fragment:t.value,key:t.value},t.render())})};FlatModal.prototype.render=function(){var _this=this;var _a=this.props,className=_a.className,title=_a.title;var crumbs=this.state.crumbs;return React.createElement("div",{className:classNames("flat-modal",className)},title,React.createElement("div",{className:"tabs"},this.renderTabs()),React.createElement("div",{className:"tab-content"},React.createElement(caladan_1.RouterCore,{crumbs:crumbs,onChange:function(c){return _this.setCrumbs(c)}},this.renderRoutes())))};return FlatModal}(React.Component);exports.FlatModal=FlatModal;