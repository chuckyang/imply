"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");require("./ingestion-type-selection.css");var React=require("react");var classNames=require("classnames");var caladan_1=require("@implydata/caladan");var beltful_1=require("@implydata/beltful");var Icons=require("@implydata/little-pictures");var imply_ui_common_1=require("@implydata/imply-ui-common");var strings_1=require("../../../common/utils/constants/strings");exports.INGESTION_TYPES_LIST_ITEMS=[{type:"kafka",title:"Apache Kafka",icon:"assets/icons/loader-kafka.png"},{type:"kinesis",title:"AWS Kinesis",disabled:true,icon:"assets/icons/loader-kinesis.png"},{type:"s3-local",title:"AWS S3",icon:"assets/icons/loader-s3.png"},{type:"batch-EMR",title:"HDFS",disabled:true,icon:"assets/icons/loader-hdfs.png"},{type:"batch-http",title:"HTTP",disabled:true,icon:"assets/icons/loader-http.png"},{type:"local-file",title:"Local file",disabled:true,icon:"assets/icons/loader-local.png"},{type:"other-batch",title:"Other",icon:"assets/icons/loader-other.png"}];var IngestionTypeSelection=function(_super){tslib_1.__extends(IngestionTypeSelection,_super);function IngestionTypeSelection(){var _this=_super.call(this)||this;_this.state={};return _this}IngestionTypeSelection.prototype.componentDidMount=function(){var _this=this;window.onpopstate=function(){_this.props.browserBack()}};IngestionTypeSelection.prototype.onOnboardClick=function(item){var _a=this.props,onOnboardClick=_a.onOnboardClick,cluster=_a.cluster;onOnboardClick(item.type,item.example,cluster)};IngestionTypeSelection.prototype.renderListItem=function(item,key,forceEnable){var _this=this;if(forceEnable===void 0){forceEnable=false}var enableAll=Boolean(window.__enable_all__);var disabled=!forceEnable&&item.disabled&&!enableAll;return React.createElement("li",{key:key,onClick:function(){return _this.onOnboardClick(item)},className:classNames("task-type",{disabled:disabled})},React.createElement("img",{src:beltful_1.MountPoint.mount(item.icon)}),React.createElement("div",{className:"title"},item.title))};IngestionTypeSelection.prototype.render=function(){var _this=this;var _a=this.props,back=_a.back,cluster=_a.cluster,getCapabilities=_a.getCapabilities,supportsLocalFileUpload=_a.supportsLocalFileUpload,exampleDatasets=_a.exampleDatasets;var capabilities=getCapabilities(cluster);if(!capabilities)capabilities=imply_ui_common_1.Capabilities.EMPTY;var examples;if(exampleDatasets&&Array.isArray(exampleDatasets)&&exampleDatasets.length){var exampleDatasetToListItem_1=function(example){return tslib_1.__assign({},example,{example:example.name})};examples=[React.createElement("div",{className:"list-title",key:"examples-title"},strings_1.STRINGS.examples),React.createElement("ul",{className:"list",key:"examples-content"},exampleDatasets.map(function(example){return _this.renderListItem(exampleDatasetToListItem_1(example),example.name)}))]}return React.createElement("div",{className:"ingestion-type-selection stretchable-width"},React.createElement("div",{className:"title-bar"},React.createElement(caladan_1.Button,{className:"back",svg:Icons.BACK,type:"light",onClick:function(){return back()}}),React.createElement("div",{className:"title"},strings_1.STRINGS.addDataset)),React.createElement("div",{className:"tabless-content has-button-bar"},React.createElement("ul",{className:"list"},exports.INGESTION_TYPES_LIST_ITEMS.map(function(item){var enable=false;if(item.type==="local-file"&&supportsLocalFileUpload&&capabilities.supportsLocalFileUpload()){enable=true}if(item.type==="kinesis"&&capabilities.supportsKinesis()){enable=true}if(item.type==="batch-http"&&capabilities.supportsHTTPIngestion()){enable=true}return _this.renderListItem(item,item.type,enable)})),examples),React.createElement("div",{className:"main-button-bar"},React.createElement(caladan_1.Button,{className:"back",title:strings_1.STRINGS.cancel,type:"secondary",onClick:function(){return back()}})))};return IngestionTypeSelection}(React.Component);exports.IngestionTypeSelection=IngestionTypeSelection;