"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var immutable_class_1=require("immutable-class");var React=require("react");var classNames=require("classnames");var dropdown_1=require("../../core/dropdown/dropdown");var info_manager_1=require("../../core/info-manager/info-manager");var immutable_utils_1=require("../immutable-utils/immutable-utils");var ImmutableDropdown=function(e){tslib_1.__extends(t,e);function t(){return e.call(this)||this}t.specialize=function(){return t};t.simpleGenerator=function(e,r,n,a,i){return function(o,l,s){if(s===void 0){s=false}var u=t.specialize();var p=immutable_utils_1.getLabel(o,n);return React.createElement(u,{key:"dropdown-"+o,items:l,instance:e,path:o,equal:immutable_class_1.generalEqual,renderItem:function(e){return e?e.label:""},keyItem:function(e){return e.value||"default_value"},itemToValue:function(e){return e?e.value:""},onChange:r,focusOnStartUp:s,helpTitle:p.label,helpText:p.description,insideId:i,errorText:a[o]})}};t.prototype.onChange=function(e){var t=this.props,r=t.instance,n=t.path,a=t.onChange,i=t.itemToValue;a(r.deepChange(n,i(e)),true,n,undefined)};t.prototype.onFocus=function(){var e=this.props,t=e.showHelpOnFocus,r=e.path,n=e.helpTitle,a=e.helpText,i=e.errorText;if(t){info_manager_1.InfoManager.show({sourceId:r,title:n,lines:[a,i].filter(Boolean),type:i?"error":"info"})}};t.prototype.onBlur=function(){if(this.props.showHelpOnFocus)info_manager_1.InfoManager.hide(this.props.path)};t.prototype.render=function(){var e=this.props,t=e.label,r=e.items,n=e.equal,a=e.renderItem,i=e.keyItem,o=e.itemToValue,l=e.instance,s=e.path,u=e.focusOnStartUp,p=e.disabled,c=e.showHelpOnFocus,m=e.insideId;var d=dropdown_1.Dropdown.specialize();var f=l.deepGet(s);var h=immutable_class_1.SimpleArray.find(r,function(e){return n(o(e),f)});return React.createElement(d,{className:classNames("immutable-dropdown","input",s),disabled:p,label:t,items:r,insideId:m,selectedItem:h,equal:function(e,t){return n(o(e),o(t))},renderItem:a,keyItem:i,onSelect:this.onChange.bind(this),focusOnStartUp:u,onFocus:c?this.onFocus.bind(this):null,onBlur:c?this.onBlur.bind(this):null})};return t}(React.Component);exports.ImmutableDropdown=ImmutableDropdown;