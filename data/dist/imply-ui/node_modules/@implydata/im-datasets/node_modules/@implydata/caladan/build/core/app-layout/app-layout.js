"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var React=require("react");var beltful_1=require("@implydata/beltful");var resize_handle_1=require("../resize-handle/resize-handle");var H_GAP=4;var V_GAP=4;var AppLayout=function(t){tslib_1.__extends(e,t);function e(){var r=t.call(this)||this;r.state={constraints:e.DEFAULT_CONSTRAINTS,allowResize:e.DEFAULT_ALLOW_RESIZE};return r}e.prototype.getStoredValue=function(t){var r=t.localStorageId,a=t.defaultValues;var i=Object.assign({},e.DEFAULT_VALUES,a||{});if(!r)return i;var o=beltful_1.LocalStorage.get(r);if(o){return Object.assign(i,o)}return i};e.prototype.initFromProps=function(t){var r=this.state.storedValues;var a={};var i=false;if(!r){a.storedValues=this.getStoredValue(t);i=true}if(t.allowResize){a.allowResize=Object.assign({},e.DEFAULT_ALLOW_RESIZE,t.allowResize);i=true}if(t.constraints){a.constraints=Object.assign({},e.DEFAULT_CONSTRAINTS,t.constraints);i=true}if(i)this.setState(a)};e.prototype.componentWillMount=function(){this.initFromProps(this.props)};e.prototype.componentWillReceiveProps=function(t){this.initFromProps(t)};e.prototype.renderTop=function(){var t=this.props,e=t.top,r=t.left,a=t.right;var i=this.state.storedValues;if(!e)return null;var o={left:r?i.left+H_GAP/2:0,right:a?i.right+H_GAP/2:0,height:i.top-V_GAP/2};return React.createElement("div",{className:"top-part",style:o},e)};e.prototype.renderRight=function(){var t=this.props.right;var e=this.state.storedValues;if(!t)return null;return React.createElement("div",{className:"right-part",style:{width:e.right-H_GAP/2}},t)};e.prototype.onPanelResize=function(t,e){var r=this.props.localStorageId;var a=this.state.storedValues;a[t]=e;this.setState({storedValues:a});beltful_1.LocalStorage.set(r,a)};e.prototype.renderHandle=function(t){var e=this;var r=this.props,a=r.onResizeEnd,i=r.localStorageId;var o=this.state,s=o.storedValues,n=o.allowResize,l=o.constraints;if(!i)return null;if(!this.props[t])return null;if(n[t]===false)return null;return React.createElement(resize_handle_1.ResizeHandle,{side:t,hideIcon:true,initialValue:s[t],onResize:function(r){return e.onPanelResize(t,r)},onResizeEnd:a,min:l[t].min,max:l[t].max})};e.prototype.renderBottom=function(){var t=this.props,e=t.bottom,r=t.left,a=t.right;var i=this.state.storedValues;if(!e)return null;var o={left:r?i.left+H_GAP/2:0,right:a?i.right+H_GAP/2:0,height:i.bottom-V_GAP/2};return React.createElement("div",{className:"bottom-part",style:o},e)};e.prototype.renderLeft=function(){var t=this.props.left;var e=this.state.storedValues;if(!t)return null;return React.createElement("div",{className:"left-part",style:{width:e.left-H_GAP/2}},t)};e.prototype.renderMain=function(){var t=this.props,e=t.children,r=t.top,a=t.right,i=t.bottom,o=t.left;var s=this.state.storedValues;var n={left:o?s.left+H_GAP/2:0,right:a?s.right+H_GAP/2:0,top:r?s.top+V_GAP/2:0,bottom:i?s.bottom+V_GAP/2:0};return React.createElement("div",{className:"main",style:n},e)};e.prototype.render=function(){var t=this.props,e=t.top,r=t.right,a=t.bottom,i=t.left;return React.createElement("div",{className:"app-layout"},this.renderLeft(),this.renderHandle("left"),this.renderRight(),this.renderHandle("right"),this.renderTop(),this.renderHandle("top"),this.renderBottom(),this.renderHandle("bottom"),this.renderMain())};e.DEFAULT_ALLOW_RESIZE={bottom:false,top:false};e.DEFAULT_VALUES={left:240,right:240,top:75,bottom:73};e.DEFAULT_CONSTRAINTS={top:{min:50,max:100},right:{min:240,max:400},bottom:{min:50,max:100},left:{min:240,max:400}};return e}(React.Component);exports.AppLayout=AppLayout;