"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var little_pictures_1=require("@implydata/little-pictures");var classNames=require("classnames");var React=require("react");var body_portal_1=require("../body-portal/body-portal");var global_event_listener_1=require("../global-event-listener/global-event-listener");var golden_center_1=require("../golden-center/golden-center");var svg_icon_1=require("../svg-icon/svg-icon");var Modal=function(e){tslib_1.__extends(t,e);function t(){var t=e.call(this)||this;t.onEscape=function(){var e=t.props,r=e.onClose,n=e.mandatory;if(!n&&r)r()};t.onEnter=function(e){if(t.props.onEnter)t.props.onEnter(e)};t.onMouseDown=function(e){var r=t.props,n=r.onClose,a=r.mandatory,l=r.deaf;if(!n||a||l)return;var o=t.state.id;var i=document.getElementById(o);if(!i)return;var s=e.target;if(beltful_1.DOMUtils.isInside(s,i))return;n()};t.state={id:null};return t}t.prototype.componentWillMount=function(){var e=this.props.id;this.setState({id:e||"modal-"+t.counter++})};t.prototype.getChildByID=function(e,t){if(!e)return null;var r=e.length;for(var n=0;n<r;n++){var a=e[n];if(a.getAttribute&&a.getAttribute("id")===t)return a;if(a.childNodes){var l=this.getChildByID(a.childNodes,t);if(l)return l}}return null};t.prototype.renderXButton=function(){var e=this.props.onClose;if(!e)return null;return React.createElement("div",{className:"close",onClick:e},React.createElement(svg_icon_1.SvgIcon,{svg:little_pictures_1.FULL_REMOVE}))};t.prototype.render=function(){var e=this.props,t=e.className,r=e.title,n=e.children,a=e.deaf;var l=this.state.id;var o=null;if(typeof r==="string"){o=React.createElement("div",{className:"modal-title"},React.createElement("div",{className:"text"},r),this.renderXButton())}return React.createElement(body_portal_1.BodyPortal,{fullSize:true},React.createElement("div",{className:classNames("modal",t,{deaf:a})},React.createElement(global_event_listener_1.GlobalEventListener,{enter:this.onEnter,escape:this.onEscape,mouseDown:this.onMouseDown}),React.createElement("div",{className:"backdrop"}),React.createElement(golden_center_1.GoldenCenter,null,React.createElement("div",{className:"modal-window",id:l},o,n))))};t.counter=0;return t}(React.Component);exports.Modal=Modal;