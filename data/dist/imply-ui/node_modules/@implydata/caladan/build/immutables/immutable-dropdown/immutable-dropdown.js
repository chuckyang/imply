"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var immutable_class_1=require("immutable-class");var React=require("react");var classNames=require("classnames");var dropdown_1=require("../../core/dropdown/dropdown");var info_manager_1=require("../../core/info-manager/info-manager");var immutable_utils_1=require("../immutable-utils/immutable-utils");var ImmutableDropdown=function(e){tslib_1.__extends(t,e);function t(){return e.call(this)||this}t.specialize=function(){return t};t.simpleGenerator=function(e,r,n,a){return function(o,i,l){if(l===void 0){l=false}var u=t.specialize();var s=immutable_utils_1.getLabel(o,n);return React.createElement(u,{key:"dropdown-"+o,items:i,instance:e,path:o,equal:immutable_class_1.generalEqual,renderItem:function(e){return e?e.label:""},keyItem:function(e){return e.value||"default_value"},itemToValue:function(e){return e?e.value:""},onChange:r,focusOnStartUp:l,helpTitle:s.label,helpText:s.description,errorText:a[o]})}};t.prototype.onChange=function(e){var t=this.props,r=t.instance,n=t.path,a=t.onChange,o=t.itemToValue;a(r.deepChange(n,o(e)),true,n,undefined)};t.prototype.onFocus=function(){var e=this.props,t=e.showHelpOnFocus,r=e.path,n=e.helpTitle,a=e.helpText,o=e.errorText;if(t){info_manager_1.InfoManager.show({sourceId:r,title:n,lines:[a,o].filter(Boolean),type:o?"error":"info"})}};t.prototype.onBlur=function(){if(this.props.showHelpOnFocus)info_manager_1.InfoManager.hide(this.props.path)};t.prototype.render=function(){var e=this.props,t=e.label,r=e.items,n=e.equal,a=e.renderItem,o=e.keyItem,i=e.itemToValue,l=e.instance,u=e.path,s=e.focusOnStartUp,p=e.disabled,c=e.showHelpOnFocus;var m=dropdown_1.Dropdown.specialize();var d=l.deepGet(u);var f=immutable_class_1.SimpleArray.find(r,function(e){return n(i(e),d)});return React.createElement(m,{className:classNames("immutable-dropdown","input",u),disabled:p,label:t,items:r,selectedItem:f,equal:function(e,t){return n(i(e),i(t))},renderItem:a,keyItem:o,onSelect:this.onChange.bind(this),focusOnStartUp:s,onFocus:c?this.onFocus.bind(this):null,onBlur:c?this.onBlur.bind(this):null})};return t}(React.Component);exports.ImmutableDropdown=ImmutableDropdown;